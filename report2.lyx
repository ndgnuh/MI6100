#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrreprt
\begin_preamble
%% ALGORITHM %%
\usepackage{algpseudocode}
\newcommand{\Func}[2][]{%
	\def\temp{#1}%
	\ifx\temp\empty%
		\operatorname{#2}%
	\else%
		\operatorname{#2}\left(#1\right)%
	\fi%
}
\newcommand{\Break}{\textbf{break}}
\newcommand{\Continue}{\textbf{continue}}
\algrenewcommand\algorithmicrequire{\textbf{Input:}}
\algrenewcommand\algorithmicensure{\textbf{Output:}}
\renewcommand{\algorithmname}{Thủ tục}

%% LISTING %%
\usepackage{listings}
\lstdefinelanguage{custom}{
    morekeywords={Input, Output, for, end, if, in, :=, int, float,
				 trunc, round, floor, ceil, pad,
				 bool, true, false, return, zeros, ones, rand},
    sensitive=false, % keywords are not case-sensitive
    morecomment=[l]{\#}, % l is for line comment
    morestring=[b]" % defines that strings are enclosed in double quotes
} % 

%% LISTING %% 
\usepackage{inconsolata}
\lstset{
basicstyle=\ttfamily,
numberstyle=\footnotesize\bfseries\ttfamily,
extendedchars=false,
inputencoding=utf8,
xleftmargin=2em, language=custom, tabsize=3, numbers=left}
\usepackage{listingsutf8}


%% TYPOGRAPHY %%
\usepackage{newcent}
\usepackage[utf8]{vietnam}
\usepackage{indentfirst}

%% SIFT %%
\def\octave{\mathrm{octave}}
\def\numscale{s}
\def\second{\mathrm{second}}

%% PRETTY REF %%
\newrefformat{alg}{\algorithmname{} \ref{#1}}
\newrefformat{fig}{Hình \ref{#1} trang \pageref{#1}}
\newrefformat{sec}{Phần \ref{#1}}
\newrefformat{subsec}{Mục \ref{#1} trang \pageref{#1}}
\newrefformat{def}{Định nghĩa \ref{#1}}

\usepackage[a4paper, top=3.5cm, bottom=3.0cm, left=3.5cm, right=2.0cm]{geometry}

%% FOR LOOP
\usepackage{tikz}


%%
\def\definitionname{Định nghĩa}
\def\remarkname{Nhận xét}
\def\examplename{Ví dụ}
\end_preamble
\use_default_options true
\begin_modules
InStar
todonotes
fixltx2e
logicalmkup
theorems-bytype
theorems-chap-bytype
\end_modules
\maintain_unincluded_children false
\begin_local_layout
Format 66
Style Group
Category              MainText
Margin                Static
LatexType             Environment
LatexName             Group
NextNoIndent          0
LeftMargin            MMM
RightMargin           MM
PassThru              0
ParbreakIsNewline     0
ParIndent             0
ParSkip               0
ItemSep               0
TopSep                0
BottomSep             0
ParSep                0
Align                 Block
AlignPossible         Block, Left, Right, Center
Font Monospace
Preamble
	\newenvironment{Group}{}{}
EndPreamble
End
\end_local_layout
\language vietnamese
\language_package auto
\inputencoding utf8x
\fontencoding T5
\font_roman "default" "default"
\font_sans "avant" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype true
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 11
\spacing onehalf
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 4
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref page
\pdf_pdfusetitle false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\topmargin 3cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation 0.5in
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\bullet 0 1 28 -1
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%-------------------------------- macros
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\scale}{t}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\octave}{\omega}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\numoctave}{\varOmega}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\numscale}{T}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\gets}{\coloneqq}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Resize}{\operatorname{Resize}}
{\text{Resize}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\tr}{\operatorname{tr}}
{\text{tr}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\ratio}{\mathrm{ratio}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\gradient}{\operatorname{Gradient}}
{\text{Gradient}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\hessian}{\operatorname{Hessian}}
{\text{Hessian}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Magnitude}{\operatorname{Magnitude}}
{\text{Magnitude}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Orientation}{\operatorname{Orientation}}
{\text{Orientation}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Crop}{\operatorname{Crop}}
{\text{Crop}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\weights}{\operatorname{weights}}
{\text{weights}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\Histogram}{\operatorname{Histogram}}
{\text{Histogram}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\DominateOrientation}{\operatorname{HistogramPeak}}
{\text{HistogramPeak}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\argmax}{\operatorname{argmax}}
{\text{argmax}}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\second}{\operatorname{second}}
{second}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FormulaMacro
\newcommand{\LoG}{\nabla^{2}G}
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand input
filename "titlepage.tex"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Chapter
Đại cương về ảnh
\end_layout

\begin_layout Section
Ảnh
\end_layout

\begin_layout Standard
Ảnh nói chung là một biểu diễn thị giác của một sự vật sự việc nào đó.
 Trong ngữ cảnh của xử lý ảnh số, xử lý tín hiệu, ảnh (số) là sự phân bố
 màu sắc thu được từ việc số hoá các tín hiệu thu được từ các bộ cảm biến.
 Thông thường, từ 
\begin_inset Quotes eld
\end_inset

tín hiệu
\begin_inset Quotes erd
\end_inset

 được dùng để chỉ các tín hiệu ánh sáng mà con người nhìn được (theo nghĩa
 bức ảnh phổ thông).
 Tuy nhiên, từ 
\begin_inset Quotes eld
\end_inset

tín hiệu
\begin_inset Quotes erd
\end_inset

 cũng có thể bao gồm các tín hiệu mà con người không nhìn thấy được để hỗ
 trợ con người trong việc thu thập và xử lý tri thức (ví dụ: sóng hồng ngoại,
 sóng âm thanh).
 Trong khuôn khổ của báo cáo này, từ 
\begin_inset Quotes eld
\end_inset

ảnh thực
\begin_inset Quotes erd
\end_inset

 sẽ được dùng để chỉ bức ảnh thực sự (phần tín hiệu chưa rời rạc hoá); và
 từ 
\begin_inset Quotes eld
\end_inset

ảnh
\begin_inset Quotes erd
\end_inset

 sẽ được sử dụng với nghĩa 
\begin_inset Quotes eld
\end_inset

ảnh số
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Definition
\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
Ảnh số
\end_layout

\end_inset

Ký hiệu 
\begin_inset Formula $\overline{1,n}$
\end_inset

 là tập 
\begin_inset Formula $\left\{ i\right\} _{i=1}^{n}$
\end_inset

.
 Một ảnh số 
\begin_inset Formula $I$
\end_inset

 là một ánh xạ
\begin_inset Formula 
\begin{align}
I & {}\colon\overline{1,W}\times\overline{1,H}\times\overline{1,C}\to\mathbb{R},\nonumber \\
I\left(x,y,c\right) & {}=\text{giá trị kênh \ensuremath{c} của điểm ảnh tại vị trí \left(x,y\right)},\label{eq:image-def}
\end{align}

\end_inset

trong đó giá trị 
\begin_inset Formula $H,W$
\end_inset

 được gọi là chiều cao và chiều rộng của ảnh một cách tương ứng, giá trị
 
\begin_inset Formula $C$
\end_inset

 là 
\emph on
số kênh
\emph default
 của ảnh.
 Một ảnh xám có 
\begin_inset Formula $C=1$
\end_inset

, ảnh màu thường có 
\begin_inset Formula $C=3$
\end_inset

 (mỗi kênh ứng với ba màu cơ bản là đỏ, xanh lá, xanh dương) hoặc 
\begin_inset Formula $C=4$
\end_inset

 (kênh thứ tư thể hiện độ trong suốt).
 Trong trường hợp 
\begin_inset Formula $C=1$
\end_inset

, ta có thể đồng nhất 
\begin_inset Formula $I\left(x,y\right)\coloneqq I\left(x,y,c\right)$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "def:ảnh số"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Remark
Khi biểu diễn trên máy tính, ảnh được biểu diễn bằng mảng ba chiều với hai
 định dạng phổ thông: 
\begin_inset Formula $H\times W\times C$
\end_inset

 trong các thư viện xử lý ảnh truyền thống, 
\begin_inset Formula $C\times H\times W$
\end_inset

 trong các thư viện học máy.
 Cả hai trường hợp có những lưu ý như sau:
\end_layout

\begin_deeper
\begin_layout Itemize
Trục 
\begin_inset Formula $y$
\end_inset

 có hướng từ trên xuống (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Trục-y-khi-máytính"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/y-flip.png
	height 10em

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Trục 
\begin_inset Formula $y$
\end_inset

 khi biểu diễn ảnh trên máy tính.
\begin_inset CommandInset label
LatexCommand label
name "fig:Trục-y-khi-máytính"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Chỉ số thứ nhất và thứ hai tương ứng với một dòng và một cột trên ảnh, do
 đó, để lấy ra giá trị kênh 
\begin_inset Formula $c$
\end_inset

 của điểm ảnh tại vị trí 
\begin_inset Formula $\left(x,y\right)$
\end_inset

.
 Do đó, khi lập trình ta cần sử dụng cách đánh chỉ số của ma trận; có nghĩa
 rằng: lấy chỉ số 
\begin_inset Formula $\left[y,x,c\right]$
\end_inset

 (trường hợp 
\begin_inset Formula $H\times W\times C$
\end_inset

), và 
\begin_inset Formula $\left[c,y,x\right]$
\end_inset

 (trường hợp 
\begin_inset Formula $C\times H\times W$
\end_inset

).
\end_layout

\begin_layout Standard
Báo cáo sử dụng 
\begin_inset Formula $I\left(x,y,c\right)$
\end_inset

 (ngoặc tròn) để lấy ra giá trị điểm ảnh theo 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:image-def"
plural "false"
caps "false"
noprefix "false"

\end_inset

, và 
\begin_inset Formula $I\left[y,x,c\right]$
\end_inset

 để lấy giá trị điểm ảnh theo cách đánh chỉ số ma trận.
 Nếu không nói gì khác, ảnh đầu vào tại bước đang xét được sắp xếp theo
 chiều 
\begin_inset Formula $H\times W\times C$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
Trong một số trường hợp, ảnh 
\begin_inset Formula $I$
\end_inset

 không phải ảnh theo nghĩa thông thường để có thể được nhìn bởi mắt người,
 ta gọi 
\begin_inset Formula $I$
\end_inset

 là một ảnh đặc trưng.
 Số kênh của ảnh đặc trưng có thể không nằm trong những giá trị được nêu
 trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "def:ảnh số"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Section
Thao tác trên ảnh
\begin_inset CommandInset label
LatexCommand label
name "sec:imageops"

\end_inset


\end_layout

\begin_layout Standard
Với khái niệm như trên, ta có một số thao tác trên ảnh.
 Phần 
\begin_inset CommandInset ref
LatexCommand nameref
reference "sec:imageops"
plural "false"
caps "false"
noprefix "false"

\end_inset

 nói về một số thao tác trên ảnh mà sẽ được dùng trong thuật toán chi tiết
 (
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:sift-detail"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Tính gradient và hessian
\end_layout

\begin_layout Standard
Việc tính gradient, hessian sẽ sử dụng công thức tính sai phân 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 và 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-hess"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Để đơn giản hoá, những chỉ số không liên quan sẽ được lược bớt.
\begin_inset Formula 
\begin{align}
\frac{\partial f}{\partial x}\left(x_{0}\right)=f_{x}\left(x_{0}\right) & =\frac{f\left(x_{0}+h\right)-f\left(x_{0}-h\right)}{2h},\label{eq:diff-grad}\\
\frac{\partial^{2}f}{\partial x\partial y}=f_{xy}\left(x_{0},y_{0}\right) & =\frac{1}{2h}\left[\frac{\partial f}{\partial x}\left(x_{0},y_{0}+h\right)-\frac{\partial f}{\partial x}\left(x_{0},y_{0}-h\right)\right]\nonumber \\
 & =\frac{1}{4h^{2}}\left[f\left(x_{0}+h,y_{0}+h\right)-f\left(x_{0}-h,y_{0}+h\right)\right]\nonumber \\
 & \phantom{={}}-\frac{1}{4h^{2}}\left[f\left(x_{0}+h,y_{0}-h\right)-f\left(x_{0}-h,y_{0}-h\right)\right],\label{eq:diff-hess}
\end{align}

\end_inset

Để áp dụng công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 và 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:diff-hess"
plural "false"
caps "false"
noprefix "false"

\end_inset

 trên ảnh, ta cần các toạ độ là nguyên, do đó lựa chọn 
\begin_inset Formula $h$
\end_inset

 bé nhất có thể sao cho 
\begin_inset Formula $x\pm h$
\end_inset

 nguyên.
 Như vậy 
\begin_inset Formula $h=1$
\end_inset

.
 Công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 và 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-hess"
plural "false"
caps "false"
noprefix "false"

\end_inset

 trở thành
\begin_inset Formula 
\begin{align*}
f_{x}\left(x_{0}\right) & =\frac{1}{2}\left[f\left(x_{0}+1\right)-f\left(x_{0}-1\right)\right],\\
f_{xy}\left(x_{0},y_{0}\right) & =\frac{1}{4}[f\left(x_{0}+1,y_{0}+1\right)-f\left(x_{0}-1,y_{0}+1\right)\\
 & \phantom{=\frac{1}{4}[}-f\left(x_{0}+1,y_{0}-1\right)+f\left(x_{0}-1,y_{0}-1\right)].
\end{align*}

\end_inset

Xét 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-hess"
plural "false"
caps "false"
noprefix "false"

\end_inset

, riêng trường hợp 
\begin_inset Formula $x=y$
\end_inset

:
\begin_inset Formula 
\[
f_{xx}\left(x_{0}\right)=\frac{1}{4h^{2}}\left[f\left(x_{0}+2h\right)-2f\left(x_{0}\right)+f\left(x_{0}-2h\right)\right],
\]

\end_inset

ở đây ta có thể chọn 
\begin_inset Formula $h=0.5$
\end_inset

, khi đó công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:diff-hess"
plural "false"
caps "false"
noprefix "false"

\end_inset

 cho trường hợp 
\begin_inset Formula $x=y$
\end_inset

 là:
\begin_inset Formula 
\[
f_{xx}\left(x_{0}\right)=f\left(x_{0}+1\right)-2f\left(x_{0}\right)+f\left(x_{0}-1\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Như vậy, gradient 
\begin_inset Formula $\mathbf{G}_{I}\left(\mathbf{x}\right)\in\mathbb{R}^{d}$
\end_inset

 và hessian 
\begin_inset Formula $\mathbf{H}_{I}\left(\mathbf{x}\right)\in\mathbb{R}^{d\times d}$
\end_inset

 của một ảnh được xác định bởi 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:image-grad"
plural "false"
caps "false"
noprefix "false"

\end_inset

 và 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:image-hessian"
plural "false"
caps "false"
noprefix "false"

\end_inset

, trong đó 
\begin_inset Formula $d$
\end_inset

 là số chiều của ảnh.
\begin_inset Formula 
\begin{align}
\left[\mathbf{G}_{I}\left(\mathbf{x}\right)\right]_{i} & =\left[\frac{\partial I}{\partial\mathbf{x}_{i}}\left(\mathbf{x}\right)\right]_{d},\quad i=\overline{1,d},\label{eq:image-grad}\\
\left[\mathbf{H}_{I}\left(\mathbf{x}\right)\right]_{i,j} & =\left[\frac{\partial I}{\partial\mathbf{x}_{i}\partial\mathbf{x}_{j}}\left(\mathbf{x}\right)\right]_{d\times d},\quad i=\overline{1,d},j=\overline{1,d}.\label{eq:image-hessian}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
Từ đó ta có thủ tục tính gradient và hessian của ảnh.
 Gradient của ảnh ba chiều được thể hiện trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:gradient-3d"
plural "false"
caps "false"
noprefix "false"

\end_inset

, trường hợp hai chiều trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:imgradient-2d"
plural "false"
caps "false"
noprefix "false"

\end_inset

 có thể được thu được bằng cách loại bỏ chiều thứ ba trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:gradient-3d"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Việc tính hessian trong trường hợp ba chiều được mô tả trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:imhessian-3d"
plural "false"
caps "false"
noprefix "false"

\end_inset

, trường hợp hai chiều được tính toán tương tự.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{[
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}] 
\backslash
gets 
\backslash
operatorname{size}
\backslash
left(
\backslash
ensuremath{I}
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad} 
\backslash
gets 
\backslash
operatorname{zeros}
\backslash
left(
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}, 2
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
For{
\backslash
ensuremath{   
\backslash
ensuremath{
\backslash
ensuremath{i} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{m}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{j} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{n}-1
\backslash
right)}}} 
\end_layout

\begin_layout Plain Layout

    
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad[i, j, 1]} 
\backslash
gets 
\backslash
left(
\backslash
ensuremath{I[i + 1, j]}-
\backslash
ensuremath{I[i - 1, j]}
\backslash
right)/2}
\end_layout

\begin_layout Plain Layout

    
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad[i, j, 2]} 
\backslash
gets 
\backslash
left(
\backslash
ensuremath{I[i, j + 1]}-
\backslash
ensuremath{I[i, j - 1]}
\backslash
right)/2}
\end_layout

\begin_layout Plain Layout


\backslash
EndFor{}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
Return 
\backslash
ensuremath{
\backslash
mathrm{grad}}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tính gradient (trường hợp hai chiều)
\begin_inset CommandInset label
LatexCommand label
name "alg:imgradient-2d"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{[
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}, 
\backslash
ensuremath{p}] 
\backslash
gets 
\backslash
operatorname{size}
\backslash
left(
\backslash
ensuremath{I}
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad} 
\backslash
gets 
\backslash
operatorname{zeros}
\backslash
left(
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}, 
\backslash
ensuremath{p}, 3
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
For{
\backslash
ensuremath{   
\backslash
ensuremath{
\backslash
ensuremath{i} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{m}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{j} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{n}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{k} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{p}-1
\backslash
right)}}} 
\end_layout

\begin_layout Plain Layout

    
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad[i, j, k, 1]} 
\backslash
gets 
\backslash
left(
\backslash
ensuremath{I[i + 1, j, k]}-
\backslash
ensuremath{I[i - 1, j, k]}
\backslash
right)/2}
\end_layout

\begin_layout Plain Layout

    
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad[i, j, k, 2]} 
\backslash
gets 
\backslash
left(
\backslash
ensuremath{I[i, j + 1, k]}-
\backslash
ensuremath{I[i, j - 1, k]}
\backslash
right)/2}
\end_layout

\begin_layout Plain Layout

    
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{grad[i, j, k, 3]} 
\backslash
gets 
\backslash
left(
\backslash
ensuremath{I[i, j, k + 1]}-
\backslash
ensuremath{I[i, j, k - 1]}
\backslash
right)/2}
\end_layout

\begin_layout Plain Layout


\backslash
EndFor{}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
Return 
\backslash
ensuremath{
\backslash
mathrm{grad}}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tính gradient (trường hợp ba chiều)
\begin_inset CommandInset label
LatexCommand label
name "alg:gradient-3d"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

  
\backslash
State 
\backslash
ensuremath{[
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}, 
\backslash
ensuremath{p}] 
\backslash
gets 
\backslash
operatorname{size}
\backslash
left(
\backslash
ensuremath{I}
\backslash
right)}
\end_layout

\begin_layout Plain Layout

  
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess} 
\backslash
gets 
\backslash
operatorname{zeros}
\backslash
left(
\backslash
ensuremath{m}, 
\backslash
ensuremath{n}, 
\backslash
ensuremath{p}, 3, 3
\backslash
right)}
\end_layout

\begin_layout Plain Layout

  
\backslash
For{
\backslash
ensuremath{   
\backslash
ensuremath{
\backslash
ensuremath{i} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{m}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{j} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{n}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{k} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{p}-1
\backslash
right)}}} 
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 1, 1]} 
\backslash
gets (
\backslash
ensuremath{I[i + 1, j, k]}+
\backslash
ensuremath{I[i - 1, j, k]})-(
\backslash
ensuremath{I[i, j, k]}*2)}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 2, 2]} 
\backslash
gets (
\backslash
ensuremath{I[i, j + 1, k]}+
\backslash
ensuremath{I[i, j - 1, k]})-(
\backslash
ensuremath{I[i, j, k]}*2)}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 3, 3]} 
\backslash
gets (
\backslash
ensuremath{I[i, j, k + 1]}+
\backslash
ensuremath{I[i, j, k - 1]})-(
\backslash
ensuremath{I[i, j, k]}*2)}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 1, 2]} 
\backslash
gets (
\backslash
ensuremath{I[i + 1, j + 1, k]}+
\backslash
ensuremath{I[i - 1, j - 1, k]}-
\backslash
ensuremath{I[i + 1, j - 1, k]}-
\backslash
ensuremath{I[i - 1, j + 1, k]})/4}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 1, 3]} 
\backslash
gets (
\backslash
ensuremath{I[i + 1, j, k + 1]}+
\backslash
ensuremath{I[i - 1, j, k - 1]}-
\backslash
ensuremath{I[i + 1, j, k - 1]}-
\backslash
ensuremath{I[i - 1, j, k + 1]})/4}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 2, 3]} 
\backslash
gets (
\backslash
ensuremath{I[i, j + 1, k + 1]}+
\backslash
ensuremath{I[i, j - 1, k - 1]}-
\backslash
ensuremath{I[i, j + 1, k - 1]}-
\backslash
ensuremath{I[i, j - 1, k + 1]})/4}
\end_layout

\begin_layout Plain Layout

  
\backslash
EndFor{}
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

  
\backslash
For{
\backslash
ensuremath{   
\backslash
ensuremath{
\backslash
ensuremath{i} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{m}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{j} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{n}-1
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{k} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(2, 
\backslash
ensuremath{p}-1
\backslash
right)}}} 
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 2, 1]} 
\backslash
gets 
\backslash
mathrm{hess[i, j, k, 1, 2]}}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 3, 1]} 
\backslash
gets 
\backslash
mathrm{hess[i, j, k, 1, 3]}}
\end_layout

\begin_layout Plain Layout

        
\backslash
State 
\backslash
ensuremath{
\backslash
mathrm{hess[i, j, k, 3, 2]} 
\backslash
gets 
\backslash
mathrm{hess[i, j, k, 2, 3]}}
\end_layout

\begin_layout Plain Layout

  
\backslash
EndFor{}
\end_layout

\begin_layout Plain Layout

  
\backslash
State 
\backslash
Return 
\backslash
ensuremath{
\backslash
mathrm{hess}}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tính hessian ảnh (trường hợp ba chiều)
\begin_inset CommandInset label
LatexCommand label
name "alg:imhessian-3d"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Thay đổi kích thước
\end_layout

\begin_layout Standard
Với ảnh 
\begin_inset Formula $I$
\end_inset

 kích thước 
\begin_inset Formula $m\times n$
\end_inset

, ta có thể thu nhỏ hoặc phóng to ảnh về kích thước 
\begin_inset Formula $m'\times n'$
\end_inset

 bằng nhiều cách khác nhau.
 Dù cách phổ biến hơn là nội suy song tuyến, báo cáo sẽ trình bày cách thu
 nhỏ được sử dụng trong 
\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

, đó là lấy mẫu trên ảnh 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:imresize-subsample"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Để thuận tiện cho việc trình bày, báo cáo ký hiệu thao tác 
\begin_inset Formula $\Resize\left(I,\ratio=r\right)$
\end_inset

 là thao tác thay đổi kích thước ảnh 
\begin_inset Formula $I$
\end_inset

 cỡ 
\begin_inset Formula $m\times n$
\end_inset

 để thu được ảnh 
\begin_inset Formula $I'$
\end_inset

 cỡ 
\begin_inset Formula $\left(m\cdot r\right)\times\left(n\cdot r\right)$
\end_inset

.
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Require
\end_layout

\end_inset

 Ảnh 
\begin_inset Formula $I$
\end_inset

, chiều cao mới 
\begin_inset Formula $h'$
\end_inset

 và chiều rộng mới 
\begin_inset Formula $w'$
\end_inset

,
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Ensure
\end_layout

\end_inset

 Ảnh đã thay đổi kích thước 
\begin_inset Formula $I'$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{[
\backslash
ensuremath{h}, 
\backslash
ensuremath{w}] 
\backslash
gets 
\backslash
operatorname{size}
\backslash
left(
\backslash
ensuremath{I}
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{[
\backslash
ensuremath{r_h}, 
\backslash
ensuremath{r_w}] 
\backslash
gets [
\backslash
ensuremath{h}/
\backslash
ensuremath{h'}, 
\backslash
ensuremath{w}/
\backslash
ensuremath{w'}]}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
ensuremath{I'} 
\backslash
gets 
\backslash
operatorname{zeros}
\backslash
left(
\backslash
operatorname{eltype}
\backslash
left(
\backslash
ensuremath{I}
\backslash
right), 
\backslash
ensuremath{w'}, 
\backslash
ensuremath{w'}
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
For{
\backslash
ensuremath{   
\backslash
ensuremath{
\backslash
ensuremath{i'} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(1, 
\backslash
ensuremath{h'}
\backslash
right)},    
\backslash
ensuremath{
\backslash
ensuremath{j'} 
\backslash
gets 
\backslash
operatorname{range}
\backslash
left(1, 
\backslash
ensuremath{w'}
\backslash
right)}}} 
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
ensuremath{i} 
\backslash
gets 
\backslash
operatorname{trunc}
\backslash
left(
\backslash
mathrm{Int}, 
\backslash
ensuremath{r_h}*
\backslash
ensuremath{i'}+0.5
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
ensuremath{j} 
\backslash
gets 
\backslash
operatorname{trunc}
\backslash
left(
\backslash
mathrm{Int}, 
\backslash
ensuremath{r_w}*
\backslash
ensuremath{j'}+0.5
\backslash
right)}
\end_layout

\begin_layout Plain Layout


\backslash
State 
\backslash
ensuremath{
\backslash
ensuremath{I'[i', j']} 
\backslash
gets 
\backslash
ensuremath{I[i, j]}}
\end_layout

\begin_layout Plain Layout


\backslash
EndFor{}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $I'$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Thu nhỏ ảnh bằng cách lấy mẫu
\begin_inset CommandInset label
LatexCommand label
name "alg:imresize-subsample"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Cho ảnh xám cỡ 
\begin_inset Formula $3\times4$
\end_inset


\begin_inset Formula 
\[
I=\left[\begin{array}{cccc}
1 & 4 & 7 & 10\\
2 & 5 & 8 & 11\\
3 & 6 & 9 & 12
\end{array}\right],
\]

\end_inset

dùng 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:imresize-subsample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 để thay đổi kích thước ảnh thành 
\begin_inset Formula $4\times6$
\end_inset

, ta thu được ảnh 
\begin_inset Formula $I'$
\end_inset

: 
\begin_inset Formula 
\[
I'=\left[\begin{array}{cccccc}
1 & 1 & 4 & 7 & 7 & 10\\
2 & 2 & 5 & 8 & 8 & 11\\
2 & 2 & 5 & 8 & 8 & 11\\
3 & 3 & 6 & 9 & 9 & 12
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Subsection
Cắt ảnh 
\end_layout

\begin_layout Standard
Cho ảnh 
\begin_inset Formula $I$
\end_inset

 kích thước 
\begin_inset Formula $m\times n$
\end_inset

, thao tác cắt ảnh là thao tác lấy ra một trên ảnh với toạ độ 
\begin_inset Formula $x_{1},y_{1},x_{2},y_{2}$
\end_inset

 cho trước.
 Ảnh thu được 
\begin_inset Formula $I'$
\end_inset

 có kích thước 
\begin_inset Formula $\left(x_{2}-x_{1}\right)\times\left(y_{2}-y_{1}\right)$
\end_inset

 và được xác định bởi:
\begin_inset Foot
status open

\begin_layout Plain Layout
Trong các thư viện làm việc với mảng, việc crop ảnh có thể được thực hiện
 dễ dàng và nhanh chóng bằng thao tác 
\begin_inset Quotes eld
\end_inset

slice
\begin_inset Quotes erd
\end_inset

.
 Ví dụ, trong trường hợp ảnh được biểu diễn bằng mảng 
\begin_inset Formula $H\times W\times C$
\end_inset

., việc crop ảnh 
\begin_inset Formula $I$
\end_inset

 với các toạ độ 
\begin_inset Formula $x_{1},x_{2},y_{1},y_{2}$
\end_inset

 sẽ được viết trong mã nguồn là 
\noun on

\begin_inset Flex Code
status open

\begin_layout Plain Layout

\noun on
I[y1:y2, x1:x2, :]
\end_layout

\end_inset


\noun default
.
\end_layout

\end_inset


\begin_inset Formula 
\[
I'\left(x',y'\right)=\left\{ I\left(x-x',y-y'\right),x_{1}\le x\le x_{2},y_{1}\le y\le y_{2}\right\} .
\]

\end_inset

Trong báo cáo, để tiện cho việc trình bày, ký hiệu 
\begin_inset Formula $\Crop\left(I,x,y,r\right)$
\end_inset

 là thao tác cắt ảnh 
\begin_inset Formula $I$
\end_inset

 với 
\begin_inset Formula $x_{1}=x-r$
\end_inset

, 
\begin_inset Formula $x_{2}=x+r$
\end_inset

, 
\begin_inset Formula $y_{1}=y-r$
\end_inset

, 
\begin_inset Formula $y_{2}=y+r$
\end_inset

; đồng thời định nghĩa một thao tác 
\begin_inset Formula $\Crop\left(I,x,y,r\right)$
\end_inset

 hợp lệ nếu như 
\begin_inset Formula $x,y,r$
\end_inset

 thoả mãn 
\begin_inset Formula 
\begin{align*}
x-r & >0, & x+r & \le m,\\
y-r & >0, & y+r & \le n.
\end{align*}

\end_inset


\end_layout

\begin_layout Section
Đặc trưng của ảnh
\end_layout

\begin_layout Standard
Đặc trưng của ảnh không có định nghĩa cụ thể, đặc trưng có thể hiểu là một
 đoạn thông tin về một phần của ảnh, thường theo dạng 
\begin_inset Quotes eld
\end_inset

phần 
\begin_inset Formula $x$
\end_inset

 của ảnh có thông tin gì
\begin_inset Quotes erd
\end_inset

.
 Việc đặc trưng của ảnh là gì thường đi đôi với tác vụ cụ thể cần được xử
 lý.
 Đặc trưng ảnh nên có tính lặp lại, có nghĩa đặc trưng đó sẽ xuất hiện trong
 nhiều ảnh của cùng một vật thể từ nhiều góc độ hay điều kiện khác nhau.
\end_layout

\begin_layout Standard
Để tìm ra các đặc trưng của ảnh, ta sử dụng các phương pháp phát hiện đặc
 trưng.
 Vì đa số những tác vụ xử lý ảnh dùng đặc trưng làm đầu vào, có rất nhiều
 phương pháp phát hiện đặc trưng đã được nghiên cứu và phát triển.
 Các đặc trưng phát hiện bởi những phương pháp như vậy có thể được chia
 thành một số loại như sau:
\end_layout

\begin_layout Description
Cạnh.
 Cạnh là những vùng trong ảnh mà có sự thay đổi đột ngột về độ sáng của
 các điểm ảnh.
 Điều đó có nghĩa gradient của ảnh trong vùng có cạnh sẽ có giá trị lớn.
 Cạnh là đặc trưng có cấu trúc một chiều.
\end_layout

\begin_layout Description
Góc.
 Các điểm đặc trưng là những đặc trưng có dạng điểm ở trong ảnh.
 Chúng còn được gọi là góc vì những thuật toán sơ khai để tìm điểm đặc trưng
 sẽ phát hiện cạnh trước, sau đó phát hiện sự thay đổi đột ngột trong hướng
 của cạnh–tạo thành một góc.
 Điểm đặc trưng có thể không phải là góc theo nghĩa thông thường (ví dụ:
 một chấm trắng trên nền đen).
 Điểm đặc trưng là đặc trưng có cấu trúc hai chiều.
\end_layout

\begin_layout Description
Miền.
 Miền đặc trưng là đặc trưng giống với điểm đặc trưng, nhưng thay vì cung
 cấp thông tin về một trên ảnh, miền đặc trưng cung cấp thông tin mang tính
 cấu trúc về một miền ở trong ảnh.
 Miền đặc trưng thường chứa một điểm tâm miền.
 Những phương pháp phát hiện miền đặc trưng thường có thể phát hiện những
 miền quá 
\begin_inset Quotes eld
\end_inset

mượt
\begin_inset Quotes erd
\end_inset

 để có thể được phát hiện bởi phương pháp phát hiện góc.
 Tuy nhiên, sự phân biệt này nhập nhằng khi bàn tới tỉ lệ ảnh.
 Nếu một ảnh được thu nhỏ lại, một điểm đặc trưng trên đó có thể tương ứng
 với một miền đặc trưng trên ảnh gốc.
\end_layout

\begin_layout Standard
Khi phát hiện được đặc trưng của ảnh, một thao tác hay được làm là tập hợp
 các thông tin của đặc trưng đó thành một véc tơ, gọi là véc tơ đặc trưng.
 Tập danh sách tất cả véc tơ đặc trưng có thể gọi là không gian đặc trưng.
 Khi đặc trưng của ảnh được xác định nhưng không để phục vụ một tác vụ cụ
 thể mà để phục vụ như một bước trung gian, ta có thể coi kết quả đầu ra
 như một ảnh (theo nghĩa là ánh xạ từ không gian tới một giá trị), ảnh này
 được gọi là ảnh đặc trưng.
 
\end_layout

\begin_layout Section
Đối sánh ảnh
\end_layout

\begin_layout Standard
Thông thường, khi dò các đặc trưng của ảnh, ta mong muốn các đặc trưng của
 vật thể trong ảnh cũng sẽ xuất hiện ở trong những ảnh khác, bất kể những
 bức ảnh khác có độ sáng, độ tương phản, góc nhìn thay đổi...
 Khi có thể trích xuất ra những đặc trưng như vậy của vật thể từ nhiều ảnh
 khác nhau, ta có thể dùng một ảnh mẫu của vật thể để trích ra những đặc
 trưng 
\begin_inset Quotes eld
\end_inset

tham khảo
\begin_inset Quotes erd
\end_inset

, sau đó dùng những đặc trưng đó để tìm vật thể trong một khung cảnh bất
 kỳ.
 Bài toán tìm ra vật thể như vậy là bài toán đối sánh ảnh.
 Một số họ phương pháp đối sánh ảnh có thể kể ra là: 
\end_layout

\begin_layout Itemize
Những phương pháp sử dụng histogram là những phương pháp khá đơn giản.
 Trong những phương pháp này, nếu histogram của hai ảnh có mức độ trùng
 khớp nhất định, ta coi hai ảnh đó của cùng một vật thể.
 Nhược điểm chung của những phương pháp này là không xử lý được những trường
 hợp ảnh của hai vật thể không liên quan tới nhau nhưng cùng histogram.
 Phương pháp này không quan tâm tới những đặc trưng mang tính địa phương
 của ảnh.
 Ví dụ: Histogram Intersection
\begin_inset CommandInset citation
LatexCommand cite
key "HistBasedImageMatching"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Những phương pháp đối sánh ảnh sử dụng đặc trưng cạnh hoặc góc đã có quan
 tâm hơn tới những đặc trưng bậc cao
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Bậc cao hơn ở đây có thể hiểu tương đương với việc gần với nghĩa thông thường
 hơn.
\end_layout

\end_inset

 của ảnh.
 Tuy nhiên, cạnh và góc không đủ tốt để xử lý những trường hợp phức tạp.
 Cạnh chỉ chạy dọc theo ảnh của vật thể và không có sự phân biệt giữa các
 đoạn của cánh.
 Đặc trưng góc thì không phải lúc nào cũng xuất hiện trong ảnh của vật thể.
 Ví dụ: Canny Edge Detector, Harris Corner Detector
\begin_inset CommandInset citation
LatexCommand cite
key "CannyEdgeDetector,Harris1988ACC"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Những phương pháp đối sánh ảnh sử dụng miền đặc trưng quan tâm tới một đặc
 trưng bậc cao hơn và thể hiện tốt hơn các đặc trưng của vật thể, vì chúng
 quan tâm tới tính địa phương của ảnh.
 Ví dụ: Biến đổi Đặc trưng Bất biến Tỷ lệ, Laplace of Gaussian
\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Một số hướng tiếp cận khác, như dựa trên chuyển động (Optical Flow), dựa
 trên hình dạng (biến đổi Hough tổng quát), sử dụng mô hình học máy (CNN),
 sử dụng kết hợp những phương pháp trên
\begin_inset CommandInset citation
LatexCommand cite
key "SpatialTransformer,VisionTransformer,FPN"
literal "false"

\end_inset

...
\end_layout

\begin_layout Standard
Báo cáo này sẽ trình bày chi tiết về một thuật toán đối sánh sử dụng miền
 đặc trưng mang tên Biến đổi Đặc trưng Bất biến Tỷ lệ (viết tắt là SIFT).
 Đây là một phương pháp cổ điển và ổn định với góc quay, tỉ lệ, độ sáng
 và độ tương phản của ảnh.
 SIFT, sẽ phát hiện các miền đặc trưng trên ảnh, được gọi là keypoint.
 Mỗi keypoint sẽ bao gồm các thuộc tính: toạ độ, kích thước, góc chính và
 descriptor, trong đó descriptor là biểu diễn số của keypoint, có thể được
 dùng để so sánh keypoint giữa ảnh khác khác nhau.
\end_layout

\begin_layout Chapter
Biến đổi Đặc trưng Bất biến Tỷ lệ
\end_layout

\begin_layout Section
Ý tưởng và tổng quan
\begin_inset CommandInset label
LatexCommand label
name "sec:Ý-tưởng-sift"

\end_inset


\end_layout

\begin_layout Standard
SIFT là một phương pháp dựa trên đặc trưng miền.
 SIFT tìm các đặc trưng miền, được gọi là keypoint trong tài liệu gốc 
\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

.
 Mỗi keypoint của SIFT là một miền với toạ độ, độ lớn và một góc chủ đạo.
 Để hiểu được ý tưởng của SIFT, trước hết ta xem xét việc phát hiện miền
 trong trường hợp một chiều.
\end_layout

\begin_layout Standard
Trong trường hợp một chiều, việc phát hiện miền được thực hiện bằng cách
 tích chập tín hiệu 
\begin_inset Formula $I$
\end_inset

 với nhân Laplace-của-Gaussian (LoG) 
\begin_inset Formula $L\left(\sigma\right)$
\end_inset

.
 Với trường hợp một chiều, 
\begin_inset Formula $L\left(\sigma\right)$
\end_inset

 là đạo hàm cấp hai của hàm Gauss.
 Phần cực trị của 
\begin_inset Formula $I\left(x\right)\ast L\left(\sigma\right)$
\end_inset

 sẽ tương ứng với tâm của miền.
 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:1d-blob"
plural "false"
caps "false"
noprefix "false"

\end_inset

 minh họa việc dùng LoG để phát hiện miền.
 Miền trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:1d-blob-01"
plural "false"
caps "false"
noprefix "false"

\end_inset

 có thể được phát hiện với 
\begin_inset Formula $\sigma=0.325$
\end_inset

, nhưng với miền kích thước 
\begin_inset Formula $1.6$
\end_inset

 trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:1d-blob-02"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Ở đây có hai đặc tính cần lưu ý:
\end_layout

\begin_layout Itemize
Tham số 
\begin_inset Formula $\sigma$
\end_inset

 có tương quan dương với độ lớn của miền, do đó ta có thể dùng 
\begin_inset Formula $\sigma$
\end_inset

 để xác định kích thước của miền.
\end_layout

\begin_layout Itemize
Với hàm 
\begin_inset Formula $\LoG\left(x,\sigma\right)$
\end_inset

 , 
\begin_inset Formula $\sigma$
\end_inset

 càng tăng thì hàm này càng 
\begin_inset Quotes eld
\end_inset

phẳng
\begin_inset Quotes erd
\end_inset

, do đó khi tính toán, giá trị của hàm được chuẩn hóa bằng cách nhân với
 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
\end_layout

\begin_layout Itemize
Cực trị của 
\begin_inset Formula $\LoG\left(x,\sigma\right)$
\end_inset

 tương ứng với tâm và độ lớn của một miền.
\end_layout

\begin_layout Standard
Từ những tính chất trên, việc tìm miền trong trường hợp một chiều có thể
 được mô tả như sau:
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/1d-blob-detection-01.png
	display false
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Miền với độ rộng 
\begin_inset Formula $0.8$
\end_inset

, 
\begin_inset Formula $\sigma=0.325$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:1d-blob-01"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/1d-blob-detection-02.png
	display false
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Miền với độ rộng 
\begin_inset Formula $1.6$
\end_inset

, 
\begin_inset Formula $\sigma=0.325$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:1d-blob-02"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/1d-blob-detection-03.png
	display false
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Miền với độ rộng 
\begin_inset Formula $1.6$
\end_inset

, 
\begin_inset Formula $\sigma=0.75$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:1d-blob-03"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Phát hiện miền với Laplacian of Gaussian
\begin_inset CommandInset label
LatexCommand label
name "fig:1d-blob"

\end_inset

, thứ tự các biểu đồ từ trên xuống dưới: 
\begin_inset Newline newline
\end_inset

(1) Tín hiệu 
\begin_inset Formula $I\left(x\right)$
\end_inset

;
\begin_inset Newline newline
\end_inset

(2) Hàm Gauss 
\begin_inset Formula $G\left(x,\sigma\right)$
\end_inset

;
\begin_inset Newline newline
\end_inset

(3) Tín hiệu sau khi nhân chập 
\begin_inset Formula $I\left(x\right)\ast G\left(x,\sigma\right)$
\end_inset

; 
\begin_inset Newline newline
\end_inset

(4) Tín hiệu sau khi nhân chập 
\begin_inset Formula $I\left(x\right)\ast\LoG\left(x,\sigma\right)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Tìm 
\begin_inset Formula $I\left(x\right)\ast\LoG\left(x,\sigma\right)$
\end_inset

 với 
\begin_inset Formula $\sigma\in\left\{ \sigma_{1},\sigma_{2},\ldots,\sigma_{n}\right\} $
\end_inset

;
\end_layout

\begin_layout Enumerate
Tìm 
\begin_inset Formula $\left(x^{*},\sigma^{*}\right)=\argmax\left\{ I\left(x\right)*\LoG\left(x,\sigma_{i}\right)\colon i=\overline{1,n}\right\} $
\end_inset

;
\end_layout

\begin_layout Standard
trong đó, tập 
\begin_inset Formula $\left\{ \sigma_{1},\sigma_{2},\ldots,\sigma_{n}\right\} $
\end_inset

 được gọi là các tỷ lệ, và 
\begin_inset Formula $\left\{ I\left(x\right)\ast\LoG\left(x,\sigma_{i}\right)\right\} $
\end_inset

 là không gian tỷ lệ.
\end_layout

\begin_layout Standard
SIFT mở rộng ý tưởng này lên trường hợp hai chiều, tìm kiếm không gian tỷ
 lệ để phát hiện các keypoint của một ảnh 
\begin_inset Formula $I$
\end_inset

.
 Không gian tỷ lệ của SIFT được cấu trúc ở dạng một 
\begin_inset Flex Emph
status open

\begin_layout Plain Layout
tháp gauss
\end_layout

\end_inset

 bao gồm 
\begin_inset Formula $\numoctave$
\end_inset

 quãng, mỗi quãng gồm ảnh ở 
\begin_inset Formula $\numscale$
\end_inset

 thang (tỷ lệ), trong đó các ảnh ở quãng liền sau có kích thước bằng một
 nửa các ảnh của quãng liền trước, mỗi quãng ứng với một lần gấp đôi các
 giá trị 
\begin_inset Formula $\sigma$
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

.
 Ngoài ra, SIFT cũng đưa ra số lượng hóa thông minh khác để khắc phục những
 ảnh hưởng từ việc xoay ảnh, góc nhìn và độ sáng.
 Quy trình bộ dò SIFT, một cách tổng quát diễn ra như sau:
\end_layout

\begin_layout Enumerate
Tiền xử lý: ảnh được chuyển về ảnh đen trắng;
\end_layout

\begin_layout Enumerate
Tìm tháp gauss của ảnh đầu vào;
\end_layout

\begin_layout Enumerate
Tìm cực trị của tháp gauss bằng tháp sai phân gauss;
\end_layout

\begin_layout Enumerate
Định vị các cực trị để thu được các keypoint, gắn orientation cho keypoint;
\end_layout

\begin_layout Enumerate
Tính toán các descriptor ứng với mỗi keypoint;
\end_layout

\begin_layout Enumerate
Sử dụng các descriptor để đối sánh ảnh.
\end_layout

\begin_layout Standard
Các bước trên được mô tả lại dưới dạng giả mã trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:Tổng-quan-SIFT"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Khi ứng dụng thực tế, các bước từ đầu cho tới khi tìm ra descriptor được
 thực hiện trên các ảnh tham chiếu trước.
 Các descriptor của ảnh tham chiếu được lưu vào cơ sở dữ liệu.
 Khi thực hiện đối sánh, descriptor trong cơ sở dữ liệu đó sẽ được dùng
 để tìm vật thể trong ảnh mới.
 
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset


\begin_inset Formula $I'\gets$
\end_inset

 Tiền xử lý 
\begin_inset Formula $I$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{L}\gets$
\end_inset

 Tìm không gian tỷ lệ của 
\begin_inset Formula $I'$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{X}\gets$
\end_inset

 tập các cực trị của 
\begin_inset Formula $\mathcal{L}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{K}\gets$
\end_inset

 định vị và tìm góc chủ đạo của các điểm 
\begin_inset Formula $\mathbf{x}\in\mathcal{X}$
\end_inset

.
 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{D}\gets$
\end_inset

 descriptor của mỗi keypoint trong 
\begin_inset Formula $\mathcal{K}$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{K},\mathcal{D}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tổng quan SIFT
\begin_inset CommandInset label
LatexCommand label
name "alg:Tổng-quan-SIFT"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Quy trình chi tiết
\begin_inset CommandInset label
LatexCommand label
name "sec:sift-detail"

\end_inset


\end_layout

\begin_layout Subsection
Tiền xử lý
\end_layout

\begin_layout Description
Đầu
\begin_inset space ~
\end_inset

vào: Ảnh 
\begin_inset Formula $I$
\end_inset

 cỡ 
\begin_inset Formula $m\times n$
\end_inset

.
\end_layout

\begin_layout Description
Đầu
\begin_inset space ~
\end_inset

ra: Ảnh 
\begin_inset Formula $I'$
\end_inset

 cùng cỡ sau khi tiền xử lý.
\end_layout

\begin_layout Standard
Ảnh đầu vào đầu tiên được chuyển thành sang thang độ xám sử dụng công thức
\begin_inset Formula 
\[
\text{gray}=0.2126\cdot\text{red}+0.7152\cdot\text{green}+0.0722\cdot\text{blue},
\]

\end_inset

trong đó red, green, blue là giá trị sáng của kênh màu tương ứng tại một
 ví trí của ảnh.
 Quy trình chi tiết được trình bày trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:Tiền-xử-lý"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Require
\end_layout

\end_inset

 Ảnh RGB 
\begin_inset Formula $I\left(x,y,c\right)$
\end_inset

 kích thước 
\begin_inset Formula $W\times H$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Ensure
\end_layout

\end_inset

 Ảnh xám 
\begin_inset Formula $I'\left(x,y\right)$
\end_inset

 kích thước 
\begin_inset Formula $W\times H$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $x=\overline{1,W},y=\overline{1,H}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $I'\left(x,y\right)=0.2126\cdot I\left(x,y,1\right)+0.7152\cdot I\left(x,y,2\right)+0.0722\cdot I\left(x,y,3\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $I'\left(x,y\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tiền xử lý ảnh đầu vào.
\begin_inset CommandInset label
LatexCommand label
name "alg:Tiền-xử-lý"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Tìm tháp gauss
\end_layout

\begin_layout Description
Đầu
\begin_inset space ~
\end_inset

vào: Ảnh 
\begin_inset Formula $I'$
\end_inset

 đã tiền xử lý.
\end_layout

\begin_layout Description
Đầu
\begin_inset space ~
\end_inset

ra: Không gian tỷ lệ của ảnh 
\begin_inset Formula $I'$
\end_inset

, biểu diễn dưới dạng tháp gauss.
\end_layout

\begin_layout Standard
Ký hiệu các ảnh trong tháp gauss như sau: 
\begin_inset Formula 
\[
\mathcal{L}=\left\{ L_{\octave,\scale}\left(x,y\right)\colon\octave=\overline{1,\numoctave},\scale=\overline{1,\numscale}\right\} ,
\]

\end_inset

trong đó 
\begin_inset Formula $\octave$
\end_inset

 là chỉ số quãng, 
\begin_inset Formula $\scale$
\end_inset

 là chỉ số thang.
 
\begin_inset Formula $L_{\octave,\scale}$
\end_inset

 được tính sử dụng công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:scale-space-01"
plural "false"
caps "false"
noprefix "false"

\end_inset

,
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:scale-space-02"
plural "false"
caps "false"
noprefix "false"

\end_inset

 và 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:scale-space-03"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Formula 
\begin{align}
L_{1,1}\left(x,y\right) & =I'\left(x,y\right),\label{eq:scale-space-01}\\
L_{\octave+1,1}\left(x,y\right) & =\Resize\left(L_{\octave,\numscale}\left(x,y\right),\ratio=0.5\right),\quad\octave=\overline{1,\numoctave-1},\label{eq:scale-space-02}\\
L_{\octave,\scale+1}\left(x,y\right) & =G\left(x,y,\sqrt{\left(k\sigma_{\scale}\right)^{2}-\sigma_{\scale}^{2}}\right)\ast L_{\octave,\scale}\left(x,y\right),\quad\octave=\overline{1,\numoctave},\scale=\overline{1,\numscale-1}.\label{eq:scale-space-03}
\end{align}

\end_inset

Để tiện cho việc trình bày, ký hiệu một quãng là 
\begin_inset Formula $\mathcal{L}_{\octave}=\left\{ L_{\octave,\scale}\left(x,y\right)\colon\octave=\overline{1,\numoctave}\right\} $
\end_inset

.
 Ngoài ra, trong 
\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

 chỉ ra rằng, thay vì tìm 
\begin_inset Formula $L_{1,1}$
\end_inset

 theo 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:scale-space-01"
plural "false"
caps "false"
noprefix "false"

\end_inset

, nếu tăng kích thước ảnh lên gấp đôi và chỉnh độ mờ ảnh (công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:scale-space-04"
plural "false"
caps "false"
noprefix "false"

\end_inset

), số lượng keypoint tìm được tăng đáng kể.
\begin_inset Formula 
\begin{equation}
L_{1,1}\left(x,y\right)=G\left(x,y,\sqrt{\sigma_{1}^{2}-\left(2\sigma_{a}\right)^{2}}\right)\ast\Resize\left(I'\left(x,y\right),\ratio=2\right),\label{eq:scale-space-04}
\end{equation}

\end_inset

trong đó 
\begin_inset Formula $\sigma_{a}$
\end_inset

 là độ mờ giả định, được chọn mặc định là 
\begin_inset Formula $0.5$
\end_inset

.
\end_layout

\begin_layout Subsection
Tìm cực trị của không gian tỷ lệ
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu vào:
\end_layout

\end_inset

 Tháp gauss của ảnh 
\begin_inset Formula $I$
\end_inset

.
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu ra:
\end_layout

\end_inset

 Danh sách điểm cực trị trong mỗi quãng 
\begin_inset Formula $\octave$
\end_inset

, tháp sai phân gauss 
\begin_inset Formula $\mathcal{D}$
\end_inset

.
\end_layout

\begin_layout Standard
Vì các ảnh trong 
\begin_inset Formula $\mathcal{L}_{\octave}$
\end_inset

 có cùng một kích thước, ta có thể coi 
\begin_inset Formula $\mathcal{L}_{\octave}$
\end_inset

 như một ảnh ba chiều 
\begin_inset Formula $L_{\octave}\left(x,y,\scale\right)$
\end_inset

, sao cho 
\begin_inset Formula $L_{\octave,\scale}\left(x,y\right)=L_{\octave}\left(x,y,\scale\right)$
\end_inset

.
 Để tìm cực trị của không gian tỷ lệ, ta tìm cực trị của 
\begin_inset Formula $L_{\octave}\left(x,y,\scale\right)$
\end_inset

 ứng với các biến 
\begin_inset Formula $\left(x,y,\scale\right)$
\end_inset

.
 Với 
\begin_inset Formula $\octave$
\end_inset

 bất kỳ, ta có các ảnh sai phân Gauss của quãng 
\begin_inset Formula $\octave$
\end_inset

:
\begin_inset Formula 
\begin{align*}
D_{\octave}\left(x,y,\scale\right) & =L_{\octave}\left(x,y,\scale+1\right)-L_{\octave}\left(x,y,\scale\right).
\end{align*}

\end_inset

Ảnh sai phân này có một tính chất đặc biệt, đó là:
\begin_inset Formula 
\begin{align*}
G\left(x,y,k\sigma_{\octave,\scale}\right)-G\left(x,y,\sigma_{\octave,\scale}\right) & \approx\left(k-1\right)\sigma_{\octave,\scale}^{2}\LoG\left(x,y,\sigma_{\octave,\scale}\right),\\
\iff D_{\octave}\left(x,y,\scale\right) & \approx\left(k-1\right)\sigma_{\octave,\scale}^{2}L_{\octave}\left(x,y\right)\ast\LoG\left(x,y,\sigma_{\octave,\scale}\right).
\end{align*}

\end_inset

Nói cách khác, 
\begin_inset Formula $D_{\octave}\left(x,y,\scale\right)$
\end_inset

 có thể được dùng để xấp xỉ ảnh 
\begin_inset Formula $L$
\end_inset

 sau khi đã nhân chập với hàm 
\begin_inset Formula $\LoG$
\end_inset

.
 Như vậy, cực trị của 
\begin_inset Formula $D_{\octave}\left(x,y,\sigma\right)$
\end_inset

 có thể dùng để xấp xỉ cực trị của 
\begin_inset Formula $\LoG\left(x,y,\sigma\right)$
\end_inset

 và cho biết thông tin xấp xỉ của toạ độ keypoint.
 Để thuật tiện cho việc trình bày, đặt 
\begin_inset Formula $\mathbf{x}=\left(x,y,\scale\right)$
\end_inset

 sao cho 
\begin_inset Formula $D_{\octave}\left(\mathbf{x}\right)=D_{\octave}\left(x,y,\sigma_{\scale}\right)$
\end_inset

.
 Một điểm 
\begin_inset Formula $\mathbf{x}^{*}$
\end_inset

 được coi là cực tiểu không gian tỷ lệ nếu
\begin_inset Formula 
\[
D_{\octave}\left(\mathbf{x}^{*}\right)\le D_{\octave}\left(\mathbf{x}^{*}+\Delta\mathbf{x}\right)\forall\,\Delta\mathbf{x}\in\left(\left\{ -1,0,1\right\} ^{3}\backslash\left\{ \left(0,0,0\right)\right\} \right).
\]

\end_inset

Trường hợp cực đại được định nghĩa tương tự.
 Vì trong mỗi quãng, ta cần so sánh ba thang liên tiếp để tìm cực trị.
 Do đó, khi tìm tháp gauss, số thang được tính được cộng thêm ba (thay vì
 tìm 
\begin_inset Formula $\numscale$
\end_inset

 thang, ta tìm 
\begin_inset Formula $\numscale+3$
\end_inset

 thang).
 Sau bước này, ta thu được tháp sai phân gauss 
\begin_inset Formula $\left\{ \mathcal{D}_{\octave}\right\} $
\end_inset

 và tập danh sách các điểm cực trị 
\begin_inset Formula $\left\{ \mathcal{X}_{\octave}\right\} $
\end_inset

.
\end_layout

\begin_layout Subsection
Định vị keypoint
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu vào:
\end_layout

\end_inset

 Tháp sai phân gauss 
\begin_inset Formula $\left\{ \mathcal{D}_{\octave}\right\} $
\end_inset

, danh sánh cực trị 
\begin_inset Formula $\left\{ \mathcal{X}_{\octave}\right\} $
\end_inset

.
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu ra:
\end_layout

\end_inset

 Danh sách keypoint 
\begin_inset Formula $\mathcal{K}$
\end_inset

 với toạ độ và góc chủ đạo.
\end_layout

\begin_layout Standard
Xét điểm cực trị của 
\begin_inset Formula $\mathbf{x}\in\mathcal{X}_{\octave}$
\end_inset

 bất kỳ, 
\begin_inset Formula $\mathbf{x}$
\end_inset

 chỉ cho biết thông tin về những vị trí có thể có keypoint trên ảnh, do
 đó ta cần xác định vị trí chính xác của một keypoint.
 Thao tác này được gọi là định vị.
 Việc tìm keypoint gồm các bước:
\end_layout

\begin_layout Enumerate
Tìm tọa độ của keypoint ứng với 
\begin_inset Formula $\mathbf{x}$
\end_inset

 sử dụng 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:candidate-coord-algorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

, trong đó số lần lặp tối đa được chọn bằng mười.
 Trong quá trình này, các keypoint không đạt đủ điều kiện về độ tương phản,
 hoặc keypoint nằm trên cạnh (điều kiện 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:keypoint-on-edge"
plural "false"
caps "false"
noprefix "false"

\end_inset

) sẽ bị lọc ra.
 Ta thu được tập keypoint ứng cử 
\begin_inset Formula $\mathcal{C}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Tìm orientation của mỗi ứng cử keypoint 
\begin_inset Formula $K$
\end_inset

 trong 
\begin_inset Formula $\mathcal{C}$
\end_inset

 sử dụng 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:keypoint-orienatation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\begin_inset Formula $\DominateOrientation$
\end_inset

 là hàm lấy ra các góc chiếm chủ đạo trong histogram, được mô tả trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:histogram-peaks"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Sau quá trình này ta thu được tập keypoint 
\begin_inset Formula $\mathcal{K}$
\end_inset

.
 Mỗi ứng cử 
\begin_inset Formula $K$
\end_inset

 thuộc 
\begin_inset Formula $\mathcal{C}$
\end_inset

 có thể tạo ra một hoặc nhiều keypoint trong 
\begin_inset Formula $\mathcal{K}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{C}\gets\emptyset$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $\mathbf{x}\in\mathcal{X}_{\octave}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 success 
\begin_inset Formula $\gets0$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
For{
\end_layout

\end_inset

trial 
\begin_inset Formula $=1:\text{số lần lặp tối đa}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
If{
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{x}$
\end_inset

 không là tọa độ hợp lệ 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Continue
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
EndIf
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{H}\gets\frac{\partial^{2}D_{\octave}}{\partial\mathbf{x}^{2}}\left(\mathbf{x}\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{g}\gets\frac{\partial D_{\octave}\left(\mathbf{x}\right)}{\partial\mathbf{x}}\left(\mathbf{x}\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\hat{\mathbf{x}}\gets-\mathbf{H}^{\dagger}\mathbf{g}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{x}\gets\mathbf{x}+\hat{\mathbf{x}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
If{
\end_layout

\end_inset


\begin_inset Formula $\left(\hat{\mathbf{x}}_{1}<0.5\right)\land\left(\hat{\mathbf{x}}_{2}<0.5\right)\land\left(\hat{\mathbf{x}}_{3}<0.5\right)$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset

 success 
\begin_inset Formula $\gets1$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Break
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
If{
\end_layout

\end_inset

success
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 Kiểm tra
\begin_inset Formula 
\[
D_{\octave}\left(\hat{\mathbf{x}}\right)=D\left(\mathbf{x}\right)+0.5\nicefrac{\partial D_{\octave}^{T}}{\partial}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 Kiểm tra
\begin_inset Formula 
\begin{equation}
\frac{\det\left(\mathbf{H}\right)}{\tr\left(\mathbf{H}\right)}\le\frac{1+r^{2}}{r}\label{eq:keypoint-on-edge}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 Thêm 
\begin_inset Formula $\mathbf{x}$
\end_inset

 vào 
\begin_inset Formula $\mathcal{C}$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
Return
\end_layout

\end_inset


\begin_inset Formula $\mathcal{C}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tìm tọa độ keypoint
\begin_inset CommandInset label
LatexCommand label
name "alg:candidate-coord-algorithm"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\emph on

\begin_inset Formula $\mathcal{K}\gets\emptyset$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{R}_{\octave},\mathbf{\Phi}_{\octave}\gets$
\end_inset

 độ lớn và hướng của gradient của 
\begin_inset Formula $\mathcal{L}_{\octave}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $\mathbf{x}\gets\left(x,y,\scale\right)\in\mathcal{C}_{\octave}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{R_{\octave}}\left[\mathbf{x}\right]\gets\Crop\left(\mathbf{R}_{\octave},x,y,\sigma_{\scale}\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{\Phi}_{\octave}\left[\mathbf{x}\right]\gets\Crop\left(\mathbf{\Phi}_{\octave},x,y,\sigma_{\scale}\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
If{
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{R_{\octave}}\left[\mathbf{x}\right],\mathbf{\Phi}_{\octave}\left[\mathbf{x}\right]$
\end_inset

 không hợp lệ 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State 
\backslash
Continue
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $H\gets\Histogram\left(\mathbf{\Phi}_{\octave}\left[\mathbf{x}\right],\weights=\mathbf{R_{\octave}}\left[\mathbf{x}\right]\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $\phi\in\DominateOrientation\left(H\right)$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 Thêm keypoint với tọa độ 
\begin_inset Formula $\mathbf{x}$
\end_inset

 và góc 
\begin_inset Formula $\phi$
\end_inset

 vào 
\emph on

\begin_inset Formula $\mathcal{K}$
\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{K}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tìm orientation của keypoint
\begin_inset CommandInset label
LatexCommand label
name "alg:keypoint-orienatation"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Require
\end_layout

\end_inset

 Historgram 
\begin_inset Formula $H$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Ensure
\end_layout

\end_inset

 Tập các góc chủ đạo 
\begin_inset Formula $\mathcal{P}$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{P}\gets\emptyset$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\max\gets0$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $i\gets1$
\end_inset

, số lượng góc tối đa
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\phi\gets\argmax\left(H\right)$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
If{
\end_layout

\end_inset


\begin_inset Formula $i\ne1\land H\left[\phi\right]<0.8\max$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\backslash
Continue
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
For{
\end_layout

\end_inset

 
\begin_inset Formula $i\gets-4,4$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $H\left[\phi+i\right]\gets0$
\end_inset

 (mask góc 
\begin_inset Formula $\phi$
\end_inset

 và các góc gần với 
\begin_inset Formula $\phi$
\end_inset

 của histogram)
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 Thêm 
\begin_inset Formula $\phi$
\end_inset

 vào 
\begin_inset Formula $\mathcal{P}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
If{
\end_layout

\end_inset


\begin_inset Formula $i=1$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

} 
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\max=H\left[\phi\right]$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndIf
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{P}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tìm peak của histogram 
\begin_inset CommandInset label
LatexCommand label
name "alg:histogram-peaks"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Tính toán descriptor 
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu vào:
\end_layout

\end_inset

 Danh sách keypoint 
\begin_inset Formula $\mathcal{K}$
\end_inset

, tháp gauss của ảnh 
\begin_inset Formula $I'$
\end_inset


\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu ra:
\end_layout

\end_inset

 Tập descriptor tương ứng với mỗi keypoint 
\begin_inset Formula $\mathcal{K}$
\end_inset

.
\end_layout

\begin_layout Standard
Sau khi thành công tìm ra các keypoint, ta cần một đại lượng để so sánh
 chúng với nhau.
 Đại lượng được sử dụng để đối sánh các keypoint được gọi là descriptor.
 Xét một keypoint bất kỳ 
\begin_inset Formula $K$
\end_inset

 tại quãng 
\begin_inset Formula $\octave$
\end_inset

, 
\begin_inset Formula $K$
\end_inset

 có toạ độ 
\begin_inset Formula $\left(x_{0},y_{0},\scale\right)$
\end_inset

 và góc chủ đạo 
\begin_inset Formula $\phi$
\end_inset

, thực hiện tìm tập điểm 
\begin_inset Formula $X=\left\{ \left(x,y\right)\colon\left|x-x_{0}\right|\le r,\left|y-y_{0}\right|\le r\right\} $
\end_inset

 với 
\begin_inset Formula 
\begin{equation}
r=4\sqrt{2}\cdot\frac{1.5\sigma_{\scale}}{2^{\octave-1}}.\label{eq:descriptor-patch-radius}
\end{equation}

\end_inset

Bán kính 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:descriptor-patch-radius"
plural "false"
caps "false"
noprefix "false"

\end_inset

 được 
\begin_inset CommandInset citation
LatexCommand cite
key "Lowe2004"
literal "false"

\end_inset

 được chọn sao cho vùng xung quanh 
\begin_inset Formula $\left(x_{0},y_{0}\right)$
\end_inset

 sẽ có 
\begin_inset Formula $16\times16$
\end_inset

 điểm ảnh.
 Sau đó, với góc chủ đạo 
\begin_inset Formula $\phi$
\end_inset

, ta thực hiện xoay những điểm trong 
\begin_inset Formula $X$
\end_inset

 với tâm xoay là 
\begin_inset Formula $\left(x_{0},y_{0}\right)$
\end_inset

 để thu được tập điểm 
\begin_inset Formula $X'=\left\{ \left(x',y'\right)\right\} $
\end_inset

.
 Việc xoay được tính toán bằng công thức 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:point-rotate"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{c}
x'\\
y'
\end{array}\right]=\left[\begin{array}{cc}
\cos\left(\phi\right) & -\sin\left(\phi\right)\\
\sin\left(\phi\right) & \cos\left(\phi\right)
\end{array}\right]\left(\left[\begin{array}{c}
x\\
y
\end{array}\right]-\left[\begin{array}{c}
x_{0}\\
y_{0}
\end{array}\right]\right)+\left[\begin{array}{c}
x_{0}\\
y_{0}
\end{array}\right].\label{eq:point-rotate}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Sau khi tìm ra 
\begin_inset Formula $X'$
\end_inset

, ta chia 
\begin_inset Formula $X'$
\end_inset

 thành các mảnh 
\begin_inset Formula $X_{i}'$
\end_inset

 có kích thước 
\begin_inset Formula $4\times4$
\end_inset

.
 Sử dụng 
\begin_inset Formula $\mathbf{\Phi}_{\octave}$
\end_inset

 thu được ở bước định vị keypoint, tạo ra các histogram 
\begin_inset Formula $H_{i}$
\end_inset

 trên tập 
\begin_inset Formula $\left\{ \mathbf{\Phi}_{\octave}\left[x,y\right]\colon\left(x,y\right)\in X'_{i}\right\} $
\end_inset

, mỗi histogram có tám bin đại diện cho các góc phần tám.
 Nếu biểu diễn histogram này như một véc tơ, ta sẽ có véc tơ 
\begin_inset Formula $8$
\end_inset

 chiều.
 Để tính ra descriptor của keypoint, ta nối các véc tơ ứng với các 
\begin_inset Formula $H_{i}$
\end_inset

 vào nhau.
 Như vậy, với mỗi keypoint, ta thu được một descriptor nằm trong 
\begin_inset Formula $\mathbb{R}^{128}$
\end_inset

.
\end_layout

\begin_layout Subsection
So sánh keypoint
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu vào:
\end_layout

\end_inset

 Tập descriptor 
\begin_inset Formula $\mathcal{D}_{1}$
\end_inset

, 
\begin_inset Formula $\mathcal{D}_{2}$
\end_inset

, tập keypoint 
\begin_inset Formula $\mathcal{K}_{1}$
\end_inset

, 
\begin_inset Formula $\mathcal{K}_{2}$
\end_inset

 của hai ảnh tương ứng.
\end_layout

\begin_layout Description
\begin_inset ERT
status open

\begin_layout Plain Layout

Đầu ra:
\end_layout

\end_inset

 Danh sách các cặp keypoint đối sánh thành công 
\begin_inset Formula $\left\{ \left(k_{1},k_{2}\right)\right\} $
\end_inset

 với 
\begin_inset Formula $k_{1}\in\mathcal{K}_{1}$
\end_inset

 và 
\begin_inset Formula $k_{2}\in\mathcal{K}_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Sau khi thu được các keypoint và các descriptor, ta cần tìm ra những cặp
 keypoint tương đồng nhau giữa hai ảnh.
 Phương pháp tìm ra các cặp là phương pháp KNN Bruteforce với 
\begin_inset Formula $k=2$
\end_inset

.
 Phương pháp được trình bày trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:Đối-sánh-keypoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

, trong đó:
\end_layout

\begin_layout Itemize
\begin_inset Formula $k_{1}$
\end_inset

 là keypoint được xét của ảnh tham chiếu,
\end_layout

\begin_layout Itemize
\begin_inset Formula $k_{2a}$
\end_inset

 là keypoint của ảnh đối sánh 
\begin_inset Formula $k_{2}$
\end_inset

 mà gần với 
\begin_inset Formula $k_{1}$
\end_inset

 nhất,
\end_layout

\begin_layout Itemize
\begin_inset Formula $k_{2b}$
\end_inset

 là keypoint của ảnh đối sánh 
\begin_inset Formula $k_{2}$
\end_inset

 mà gần với 
\begin_inset Formula $k_{1}$
\end_inset

 nhì,
\end_layout

\begin_layout Itemize
\begin_inset Formula $T$
\end_inset

 là ngưỡng tỉ lệ giữa 
\begin_inset Formula $d\left(k_{2a},k_{1}\right)$
\end_inset

 và 
\begin_inset Formula $d\left(k_{2b},k_{1}\right)$
\end_inset

, nếu tỷ lệ giữa 
\begin_inset Formula $d\left(k_{2a},k_{1}\right)$
\end_inset

 và 
\begin_inset Formula $d\left(k_{2b},k_{1}\right)$
\end_inset

 bé hơn 
\begin_inset Formula $T$
\end_inset

, 
\begin_inset Formula $\left(k_{1},k_{2a}\right)$
\end_inset

 được coi là cặp khớp nhau; mặc định 
\begin_inset Formula $T=0.6$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Require
\end_layout

\end_inset


\begin_inset Formula $\mathcal{K}_{1}$
\end_inset

, 
\begin_inset Formula $\mathcal{D}_{1}$
\end_inset

, 
\begin_inset Formula $\mathcal{K}_{2}$
\end_inset

, 
\begin_inset Formula $\mathcal{D}_{2}$
\end_inset

 là tập keypoint, descriptor tương ứng của ảnh một và ảnh ha
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Ensure 
\end_layout

\end_inset


\begin_inset Formula $\mathcal{M}$
\end_inset

 là tập các cặp keypoint đối sánh thành công
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{M}\coloneqq\emptyset$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $k_{1}\in\mathcal{K}_{1}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $d_{\min}\coloneqq\inf$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $d_{\second}\coloneqq\inf$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $k_{\min}\coloneqq$
\end_inset

 nothing
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
For{
\end_layout

\end_inset


\begin_inset Formula $k_{2}\in\mathcal{K}_{2}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset


\begin_inset Formula $d_{1}$
\end_inset

, 
\begin_inset Formula $d_{2}\coloneqq$
\end_inset

 descriptor ứng với 
\begin_inset Formula $k_{1}$
\end_inset

, 
\begin_inset Formula $k_{2}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset


\begin_inset Formula $d=\left\lVert d_{1}-d_{2}\right\rVert $
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
If{
\end_layout

\end_inset


\begin_inset Formula $d<d_{\min}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset


\begin_inset Formula $d_{\min}\coloneqq d$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset


\begin_inset Formula $k_{\min}\coloneqq k_{2}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
Else
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

			
\backslash
State
\end_layout

\end_inset


\begin_inset Formula $d_{\second}=d$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
If{
\end_layout

\end_inset


\begin_inset Formula $d_{\min}<d_{\second}\cdot T$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

		
\backslash
State
\end_layout

\end_inset

 Thêm cặp 
\begin_inset Formula $\left(k_{1},k_{\min}\right)$
\end_inset

 vào 
\begin_inset Formula $\mathcal{M}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

	
\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State 
\backslash
Return
\end_layout

\end_inset

 
\begin_inset Formula $\mathcal{M}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Đối sánh keypoint
\begin_inset CommandInset label
LatexCommand label
name "alg:Đối-sánh-keypoint"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Thử nghiệm và phân tích
\end_layout

\begin_layout Subsection
Thử nghiệm
\end_layout

\begin_layout Standard
Những thử nghiệm dưới đây được thực hiện với phiên bản cài đặt SIFT của
 thư viện OpenCV, hàm đối sánh được cài đặt theo 
\begin_inset CommandInset ref
LatexCommand formatted
reference "alg:Đối-sánh-keypoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Ảnh tham chiếu được thu nhỏ về cỡ tối đa 
\begin_inset Formula $512\times512$
\end_inset

 (thumbnail)
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Thao tác này chỉ giới hạn kích thước ảnh, không phóng to ảnh lên, nếu một
 ảnh kích thước 
\begin_inset Formula $128\times128$
\end_inset

, việc thumbnail không làm cho kích thước ảnh tnăg lên 
\begin_inset Formula $512\times512$
\end_inset

.
\end_layout

\end_inset

.
 Lý do cho việc thu nhỏ được giải thích trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "subsec:sift-downside"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Ảnh truy vấn cũng được thu nhỏ về kích thước tối đa 
\begin_inset Formula $1024\times1024$
\end_inset

.
 Danh sách các ảnh tham chiếu được trình bày trong 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Các-ảnh-tham-chiếu"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Ảnh được coi là tìm thấy nếu như số lượng keypoint đối sánh thành công
 lớn hơn mười.
 Những chi tiết nhỏ khác được trình bày ở mỗi thử nghiệm.
 Hai thử nghiệm đầu được dùng để minh hoạ chủ yếu ưu điểm của SIFT, còn
 ba thử nghiệm sau cho các nhược điểm.
 Do đó, các kết quả thí nghiệm sẽ được trình bày ở phần tương ứng.
 Những khiếm khuyết thể hiện ra trong hai thí nghiệm đầu cũng sẽ được trình
 bày ở phần nhược điểm.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/refs/box.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Bìa hộp
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/refs/cup.jpg
	lyxscale 10
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Cốc cafe
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/refs/hust.png
	lyxscale 10
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Logo Đại học Bách khoa Hà Nội
\begin_inset CommandInset label
LatexCommand label
name "fig:ref-logo-hust"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename assets/refs/tokyo_tower.jpg
	lyxscale 10
	width 100text%
	rotateAngle 90

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tháp Tokyo
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Các ảnh tham chiếu
\begin_inset CommandInset label
LatexCommand label
name "fig:Các-ảnh-tham-chiếu"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Ưu điểm
\end_layout

\begin_layout Standard
Những ưu điểm của SIFT thể hiện chủ yếu trong hai thử nghiệm đầu tiên.
 Kết quả đầu tiên (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-box-in-scene"
plural "false"
caps "false"
noprefix "false"

\end_inset

) là một ví dụ phổ biến của OpenCV.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename assets/results/box@box_in_scene.jpg
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tìm sự xuất hiện của chiếc hộp trong ảnh, hộp bị chê lấp và xoay, ảnh mẫu.
\begin_inset CommandInset label
LatexCommand label
name "fig:result-box-in-scene"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

Bìa hộp đã bị che lấp một chút, đồng thời có một sự thay đổi nhẹ ở góc nhìn.
 Vì SIFT tìm kiếm điểm ảnh trên nhiều thang khác nhau, các keypoint tìm
 được bởi SIFT ít bị ảnh hưởng bởi tỉ lệ của vật thể trong ảnh.
 Ngoài ra, cách tìm keypoint của SIFT có một số đặc trưng khiến cho keypoint
 không bị ảnh hưởng bởi độ sáng cũng như góc xoay của vật thể.
 Đầu tiên, trong bước định vị keypoint, điều kiện lọc bỏ keypoint 
\begin_inset CommandInset ref
LatexCommand formatted
reference "eq:keypoint-on-edge"
plural "false"
caps "false"
noprefix "false"

\end_inset

 khiến cho những keypoint nằm trên cạnh bị bỏ đi.
 Việc phát hiện các cạnh thường gặp khó khăn với góc xoay của ảnh, do đó
 bỏ các keypoint nằm trên cạnh giúp cho keypoint không bị ảnh hưởng bởi
 góc xoay.
 Tiếp theo, khi tìm góc chủ đạo của keypoint, góc được tính toán bằng cách
 thống kê trên lân cận của keypoint và tìm ra đỉnh của historgram.
 Điều này làm cho những góc chủ đạo được xác định bởi vùng lân cận của keypoint,
 một đặc trưng vốn không ảnh hưởng bởi góc xoay (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-box-in-scene"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Những tính chất này đồng thời khiến cho phương pháp có thể xử lý được những
 thay đổi nhỏ trong góc nhìn.
\end_layout

\begin_layout Standard
Tiếp đó là những ví dụ về chiếc cốc cà phê.
 Cốc nằm bên phải trong ảnh truy vấn, bị xoay ngược 
\begin_inset Formula $180$
\end_inset

 độ và nằm trong nhiều vật thể khác.
 Ảnh truy vấn bị thay đổi độ sáng và độ tương phản dựa trên các tham số
 thay đổi 
\begin_inset Formula $b$
\end_inset

 và 
\begin_inset Formula $c$
\end_inset

 (ứng với độ sáng và độ tương phản)
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Việc thay đổi độ sáng và độ tương phản sử dụng 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://pillow.readthedocs.io/en/stable/reference/ImageEnhance.html
\end_layout

\end_inset

, trong đó 
\begin_inset Formula $b$
\end_inset

 và 
\begin_inset Formula $c$
\end_inset

 là đầu vào của hàm 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
enhance
\end_layout

\end_inset

.
\end_layout

\end_inset

.
 Các cặp giá trị tỉ lệ tương phản 
\begin_inset Formula $c$
\end_inset

 và tỉ lệ độ sáng 
\begin_inset Formula $b$
\end_inset

 được chú thích trong mỗi hình của 
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-cup-in-scene"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Giá trị 
\begin_inset Formula $c$
\end_inset

 cao có nghĩa ảnh sẽ có độ tương phản cao và ngược lại.
 Giá trị 
\begin_inset Formula $b$
\end_inset

 được hiểu tương tự.
 Trong đa số trường hợp, chiếc cốc được tìm thành công với số lượng keypoint
 đối sánh được đều vào khoảng 
\begin_inset Formula $30$
\end_inset

, chí có một trường hợp thất bại khi ảnh rất tối (
\begin_inset Formula $b=0.2$
\end_inset

).
 Thí nghiệm này thể hiện tính vững của SIFT trước những ảnh hưởng về điều
 kiện sáng.
 Trong khi tìm descriptor cũng như tìm góc chủ đạo, SIFT bỏ qua độ lớn của
 gradient, khiến cho ảnh hưởng của độ sáng việc đối sánh không cao.
 Ngoài ra, thí nghiệm cũng cho thấy rõ hơn tính bất biến với sự xoay của
 SIFT.
 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
foreach 
\backslash
VarB/
\backslash
VarC in {1.0/0.5,1.0/1.5,0.5/1.0,1.5/1.0,0.2/1.0,0.5/0.5,1.5/1.5,0.5/1.5,1.5/0.5} {
\end_layout

\begin_layout Plain Layout

	
\backslash
hfill
\end_layout

\begin_layout Plain Layout

	
\backslash
subfloat[$c=
\backslash
VarC$, $b=
\backslash
VarB$]{
\end_layout

\begin_layout Plain Layout

		
\backslash
includegraphics[width=0.30
\backslash
textwidth]{assets/results-1024x1024/cup@cup-in-scene-c
\backslash
VarC-b
\backslash
VarB.jpg}
\end_layout

\begin_layout Plain Layout

	}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout


\backslash
subfloat[{Ảnh truy vấn gốc}]{
\end_layout

\begin_layout Plain Layout


\backslash
includegraphics[width=0.30
\backslash
textwidth]{assets/results-1024x1024/cup@cup-in-scene}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
Tìm kiếm cốc cà phê
\begin_inset CommandInset label
LatexCommand label
name "fig:result-cup-in-scene"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Nhược điểm
\begin_inset CommandInset label
LatexCommand label
name "subsec:sift-downside"

\end_inset


\end_layout

\begin_layout Standard
Nhược điểm đầu tiên của SIFT là tốn nhiều tài nguyên tính toán.
 Khi chạy thử nghiệm, ta biết trước ảnh nào cần đối sánh với ảnh nào, do
 đó quá trình chạy thử nghiệm không tốn nhiều thời gian.
 Trong ngữ cảnh ứng dụng thực tế, một ảnh truy vấn sẽ được đối sánh với
 tất cả ảnh trong cơ sở dữ liệu.
 Nếu ảnh truy vấn lớn, việc tìm ra không gian tỷ lệ và cực trị của không
 gian tỷ lệ sẽ tốn kém hơn.
 Đồng thời, nếu tạo ra quá nhiều keypoint, quá trình đối sánh cũng bị tăng
 khối lượng tính toán.
 Chính vì nhược điểm này, kích thước của ảnh bị giới hạn lại như đã trình
 bày.
 Ta cũng có thể xử lý vấn đề này bằng cách sử dụng những bộ dò khác nhanh
 thay cho việc dò trên không gian tỷ lệ của SIFT, đồng thời giữ nguyên bước
 tính toán descriptor.
 Tuy nhiên tính bất biến với tỷ lệ có thể bị phá vỡ nếu làm vậy.
\end_layout

\begin_layout Standard
Những điểm khác của SIFT thể hiện chủ yếu ở ba thí nghiệm sau.
 Kết quả thứ ba đối sánh trên logo của Đại học Bách khoa Hà Nội.
 Ảnh truy vấn được thử nghiệm thêm với thumbnail cỡ 
\begin_inset Formula $512\times512$
\end_inset

 và thumbnail 
\begin_inset Formula $4096\times4096$
\end_inset

.
 Mặc dù cặp ảnh đầu vào giữ nguyên, việc thu nhỏ kích thước ảnh truy vấn
 ảnh hưởng tới kết quả đối sánh (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-hust-logo"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Từ thử nghiệm này có thể rút ra một yếu điểm khác của SIFT, đó là kết quả
 tốt yêu cầu kích thước vật thể trong của ảnh truy vấn đủ lớn.
 Khi vật thể trong ảnh truy vấn nhỏ, số lượng keypoint đối sánh thành công
 sẽ giảm đi và vật thể khó được phát hiện hơn.
 Trong trường hợp này thuật toán không tìm ra vật thể mặc dù kích thước
 vật đủ lớn để phát hiện đối với mắt người và góc nhìn không bị thay đổi
 nhiều (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-hust-logo-512-fail"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/results-1024x1024/hust@hust-01.jpg
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ảnh nghiêng, 
\begin_inset Formula $1024\times1024$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/results-512x512/hust@hust-02.jpg
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ảnh chính diện, 
\begin_inset Formula $512\times512$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:result-hust-logo-512-fail"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/results-4096x4096/hust@hust-01.jpg
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ảnh nghiêng, 
\begin_inset Formula $4096\times4096$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename assets/results-4096x4096/hust@hust-02.jpg
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ảnh chính diện, 
\begin_inset Formula $4096\times4096$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Đối sánh trên logo Đại học Bách khoa Hà Nội
\begin_inset CommandInset label
LatexCommand label
name "fig:result-hust-logo"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Một nhược điểm khác của SIFT là không được thiết kế để xử lý việc thay đổi
 góc nhìn.
 Thí nghiệm số bốn quay lại việc tìm chiếc cốc, tuy nhiên ở hai góc nhìn
 khác.
 Góc nhìn vật thể trong ảnh truy vấn lệch dần khỏi ảnh tham chiếu (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-cup-viewpoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Lượng keypoint đối sánh thành công cũng giảm dần theo sự chênh lệch góc
 nhìn.
 Để khắc phục nhược điểm này, một số phương pháp khác ra đời dựa trên tinh
 thần của SIFT, nhưng thay vì chỉ tìm keypoint trên nhiều quãng/thang khác
 nhau, các phương pháp này tìm keypoint trên nhiều viewpoint, ví dụ như
 ASIFT
\begin_inset CommandInset citation
LatexCommand cite
key "ipol.2011.my-asift"
literal "false"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename assets/results-1024x1024/cup@cup-view-point-1.jpg
	display false
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Viewpoint thay đổi ít
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename assets/results-1024x1024/cup@cup-view-point-2.jpg
	display false
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Viewpoint thay đổi nhiều
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Số lượng keypoint ít dần khi góc nhìn lệch khỏi ảnh tham chiếu
\begin_inset CommandInset label
LatexCommand label
name "fig:result-cup-viewpoint"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Thử nghiệm cuối cùng được thực hiện trên ảnh của tháp Tokyo, mặc dù đây
 có vẻ là một trường hợp dễ, không có một keypoint nào được đối sánh thành
 công (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Tháp-Tokyo-match"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Khi vẽ minh hoạ các keypoint của vật lên ảnh tham chiếu (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:Tháp-Tokyo,-keypoint"
plural "false"
caps "false"
noprefix "false"

\end_inset

), ta thấy những keypoint thường nằm trên các góc và phạm vi của keypoint
 thường chứa nền ảnh.
 Từ cách dò keypoint và tính descriptor của SIFT, ta thấy cả descriptor
 và keypoint đều trên thông tin về một vùng địa phương của ảnh.
 Khi vật có lỗ hổng và ta thay đổi phông nền của ảnh, những thông tin địa
 phương này cũng bị thay đổi theo.
 Như vậy SIFT có vấn đề khi đối sánh những vật thể có nhiều lỗ, sự thay
 đổi phông nền sẽ ảnh hưởng rất lớn tới kết quả đối sánh.
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename assets/results/tokyo_tower@tokyo-tower.jpg
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tháp Tokyo, đối sánh thất bại
\begin_inset CommandInset label
LatexCommand label
name "fig:Tháp-Tokyo-match"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename figures/ref-tokyo-tower-keypoints.png
	width 100text%
	rotateAngle 90

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Tháp Tokyo, keypoint ảnh vật thể chứa cả nền.
\begin_inset CommandInset label
LatexCommand label
name "fig:Tháp-Tokyo,-keypoint"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

 Nhược điểm với phông nền như trên đồng thời chỉ ra một vấn đề khác với
 SIFT, đó là nó không quan tâm tới thông tin bối cảnh mà chỉ quan tâm những
 thông tin địa phương.
 Điều này dẫn đến những trường hợp dương tính giả (đối sánh thành công nhưng
 hai keypoint đối sánh được là của hai vật thể khác nhau) do trên hai ảnh
 có những 
\begin_inset Quotes eld
\end_inset

mảnh vá
\begin_inset Quotes erd
\end_inset

 giống nhau.
 Ta có thể quan sát được hiện tượng này trong cả những trường hợp đối sánh
 thất bại (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-hust-logo-512-fail"
plural "false"
caps "false"
noprefix "false"

\end_inset

) và đối sánh thành công (
\begin_inset CommandInset ref
LatexCommand formatted
reference "fig:result-box-in-scene"
plural "false"
caps "false"
noprefix "false"

\end_inset

); trong đó những điểm dương tính giả xuất hiện ở những phần ảnh có góc
 nhọn.
 Những vấn đề trên đều là những vấn đề rất khó giải quyết và mới chỉ được
 (cố gắng) giải quyết gần đây bởi những cơ chế hiện đại và phức tạp hơn
\begin_inset CommandInset citation
LatexCommand cite
key "VisionTransformer,SpatialTransformer"
literal "false"

\end_inset

.
\end_layout

\begin_layout Chapter
Kết luận
\end_layout

\begin_layout Standard
Báo cáo đã trình bày sơ lược về bài toán đối sánh ảnh cùng với một phương
 pháp xử lý rất kinh điển cho bài toán–SIFT.
 SIFT là một trong những phương pháp cổ điển đầu tiên với tính chính xác
 cao mà có thể ứng dụng trong thực tế.
 SIFT cũng có thể được linh hoạt dùng kết hợp với các bộ dò đặc trưng ở
 dạng điểm khác như bộ dò góc Harris.
 Mặc dù có nhiều nhược điểm, bộ dò SIFT có ảnh hưởng lớn tới những mô hình
 được đưa ra sau này, ví dụ như 
\begin_inset CommandInset citation
LatexCommand cite
key "DCNConv"
literal "false"

\end_inset

 hay 
\begin_inset CommandInset citation
LatexCommand cite
key "FPN"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Báo cáo này được thực hiện dưới sự hướng dẫn của TS.
\begin_inset space ~
\end_inset

Vương Mai Phương và TS.
\begin_inset space ~
\end_inset

Nguyễn Phương Thuỳ.
 Em xin cảm ơn hai cô đã nhiệt tình chỉ dẫn, góp ý và phản biện để giúp
 báo cáo này hoàn thiện hơn.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "refs"
options "plain_vi"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{Tài liệu tham khảo}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
